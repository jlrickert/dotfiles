#!/usr/bin/env bash

# Load environmental variables
SCRIPT_DIR="$(dirname "$(readlink -f "$0")")"
PROJECT_ROOT="$(cd "${SCRIPT_DIR}" && git rev-parse --show-toplevel)"
. "${PROJECT_ROOT}/lib/env.sh"

echo "--- Running Doctor Checks ---"

# Check if git is installed.
if command -v git &>/dev/null; then
	echo "✅${GREEN}git is installed.${RESET}"
else
	echo "❌${RED}git is not installed.${RESET}"
fi

# Check if curl is installed.
if command -v curl &>/dev/null; then
	echo "✅${GREEN}curl is installed.${RESET}"
else
	echo "❌${RED}curl is not installed.${RESET}"
fi

# Check if chezmoi is installed.
if command -v chezmoi &>/dev/null; then
	echo "✅${GREEN}chezmoi is installed.${RESET}"
else
	echo "❌${RED}chezmoi is not installed.${RESET}"
fi

# Check if Docker is installed.
if command -v docker &>/dev/null; then
	echo "✅${GREEN}Docker is installed.${RESET}"
else
	echo "❌${RED}Docker is not installed.${RESET}"
fi

# Check if DOTFILES_ROOT variable is set and not empty.
if [ -n "${DOTFILES_ROOT:-}" ]; then
	echo "✅${GREEN}DOTFILES_ROOT is set: ${DOTFILES_ROOT}${RESET}"
else
	echo "❌${RED}DOTFILES_ROOT is not set or is empty.${RESET}"
fi

# Check if DOTFILES_CONFIG variable is set and not empty.
if [ -n "${DOTFILES_CONFIG:-}" ]; then
	echo "✅${GREEN}DOTFILES_CONFIG is set: ${DOTFILES_CONFIG}${RESET}"
else
	echo "❌${RED}DOTFILES_CONFIG is not set or is empty.${RESET}"
fi

# Check if DOTFILES_CONFIG variable is set and not empty.
if [ -n "${DOTFILES_STATE:-}" ]; then
	echo "✅${GREEN}DOTFILES_STATE is set: ${DOTFILES_STATE}${RESET}"
else
	echo "❌${RED}DOTFILES_STATE is not set or is empty.${RESET}"
fi

echo "--- Doctor Checks Complete ---"
